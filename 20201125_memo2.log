[student@workstation DO180-apps]$ cd ..
[student@workstation ~]$ cat build_test.yaml 
apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: builds-pruner
  namespace: openshift-image-registry
spec:
  concurrencyPolicy: Forbid
  failedJobsHistoryLimit: 3
  jobTemplate:
    metadata:
      creationTimestamp: null
      labels:
        created-by: builds-pruner
    spec:
      template:
        metadata:
          creationTimestamp: null
        spec:
          affinity: {}
          containers:
          - args:
            - adm
            - prune
            - builds
            - --orphans
            - --keep-complete=0
            - --keep-failed=0
            - --keep-younger-than=1m
            - --confirm=true
            command:
            - oc
            image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:ddf1330bf78848849738ba17ae256ec2fb6d6ebe357f8857eefad913d4081eed
            imagePullPolicy: IfNotPresent
            name: builds-pruner
            resources:
              requests:
                cpu: 100m
                memory: 256Mi
            terminationMessagePath: /dev/termination-log
            terminationMessagePolicy: FallbackToLogsOnError
            volumeMounts:
            - mountPath: /var/run/configmaps/serviceca
              name: serviceca
              readOnly: true
          dnsPolicy: ClusterFirst
          restartPolicy: OnFailure
          schedulerName: default-scheduler
          securityContext: {}
          serviceAccount: tmypruner
          serviceAccountName: tmypruner
          terminationGracePeriodSeconds: 30
          volumes:
          - configMap:
              defaultMode: 420
              name: serviceca
            name: serviceca
  schedule: 15 4 * * *
  startingDeadlineSeconds: 3600
  successfulJobsHistoryLimit: 3
  suspend: false
status: {}
[student@workstation ~]$ oc get build
NAME     TYPE     FROM          STATUS     STARTED       DURATION
echo-1   Docker   Git@93ff810   Complete   3 hours ago   16s
[student@workstation ~]$ vim build_test.yaml 
[student@workstation ~]$ oc apply -f build_test.yaml 
cronjob.batch/builds-pruner configured
[student@workstation ~]$ oc get cronjob -n openshift-image-registry
NAME                 SCHEDULE     SUSPEND   ACTIVE   LAST SCHEDULE   AGE
builds-pruner        47 7 * * *   False     0        3h29m           3h31m
deployments-pruner   5 6 * * *    False     0        99m             103m
image-pruner         0 0 * * *    False     0        <none>          111d
[student@workstation ~]$ oc get pod -n openshift-image-registry
NAME                                               READY   STATUS      RESTARTS   AGE
builds-pruner-1606277700-xs6nt                     0/1     Completed   0          3h36m
builds-pruner-1606290420-8nltr                     0/1     Completed   0          4m43s
cluster-image-registry-operator-5f47f6fcf7-bh22s   2/2     Running     0          111d
deployments-pruner-1606284300-fbhgw                0/1     Completed   0          106m
echo-1-deploy                                      0/1     Completed   0          4h40m
echo-1-np2r5                                       1/1     Running     0          4h40m
image-registry-64b69c4bf9-48xl5                    1/1     Running     0          111d
node-ca-24k9d                                      1/1     Running     0          111d
node-ca-lfh4z                                      1/1     Running     0          111d
node-ca-qrrpd                                      1/1     Running     0          111d
[student@workstation ~]$ oc logs builds-pruner-1606290420-8nltr -n openshift-image-registry
NAMESPACE   NAME
default     echo-1
[student@workstation ~]$ 
[student@workstation ~]$ oc get build
No resources found in default namespace.
[student@workstation ~]$ oc get build -A
No resources found
[student@workstation ~]$ 

